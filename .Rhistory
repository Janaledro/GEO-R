###Script para alluviales
library(alluvial)
install.packages("alluvial")
install.packages("plyr")
install.packages("biobase")
install.packages("Biobase")
install.packages("GEOquery")
source("https://bioconductor.org/biocLite.R")
biocLite("GEOquery")
install.packages("XML")
install.packages("xml2")
install.packages("xml2")
install.packages("XML")
biocLite("GEOquery")
install.packages("RCurl")
install.packages("rCUR")
install.packages("curl")
install.packages("RCurl")
biocLite("GEOquery")
biocLite("GEOquery")
install.packages("ggplot2")
################################################################
#   Boxplot for selected GEO samples
library(Biobase)
library(GEOquery)
vignette(GEOquery)
vignette("GEOquery")
#A continuación se cargará la librería 'ggplot' para hacer gráficos
library("ggplot2")
library("ggplot2")
library("reshape2")
library("alluvial")
library("dplyr")
#A continuación se cargará la librería 'ggplot' para hacer gráficos
library("ggplot2")
library("reshape2")
library("alluvial")
library("dplyr")
#A continuación se leerán los datos. Se recuerda ubicar el espacio de trabajo
#con "setwd()"
GEO<-read.csv(file="data/GEO_tablet.tsv", header = T, sep = "\t",
na.strings = "", stringsAsFactors = T)
setwd("~/GEO-R/")
#A continuación se leerán los datos. Se recuerda ubicar el espacio de trabajo
#con "setwd()"
GEO<-read.csv(file="data/GEO_tablet.tsv", header = T, sep = "\t",
na.strings = "", stringsAsFactors = T)
GEO.DF<-GEO[grepl(GEO$FECHA_DE_PUBLICACION, pattern = "Public_on_"),]
#EN ESTA LÍNEA SE GENERARÁ UN DATA FRAME CON LAS LÍNEAS FALTANTES
GEO_DESFASADO.DF<-GEO[grep(GEO$FECHA_DE_PUBLICACION, pattern = "Public_on_", invert = T),]
SPPs <- as.character(GEO.DF$ORGANISMO)
SPPstr<-unlist(strsplit(SPPs, split = ","))
ESPECIES<-grep("!Sample_", SPPstr, value = T, invert = T)
ESPECIES.DF<- data.frame(ESPECIES, stringsAsFactors = T)
ESPECIES.DF<-droplevels(ESPECIES.DF)
my.summary<-summary(ESPECIES.DF, maxsum = 7)
my.summary<-as.data.frame(do.call(rbind, strsplit(as.character(my.summary),
split = ":")))
my.summary
colnames(my.summary) <- c("ORGANISMO","NUMERO_DE_ENTRADAS_EN_LA_TABLA")
my.summary
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x=ORGANISMO, y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Dark2")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Dark2")
bp
pie <- bp + coord_polar("y", start=0)
pie
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Accent")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="BrBG")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="PiYG")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="PRGn")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="PuOr")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Spectral")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="RdYlGn")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Paired")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Pastel1")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Pastel2")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Set1")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Set2")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Set3")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Accent")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="BuGn")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Accent")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="RdYlBu")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Paired")
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Dark2")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Accent")
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_gradientn(
colours = terrain.colors(6) )
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_gradientn(
colours = terrain.colors(6) )
#También: rainbow(),
#heat.colors(), topo.colors(),
#cm.colors(),
RColorBrewer::brewer.pal()
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_gradientn(
colours = terrain.colors(7) )
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Set1")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Set2")
bp
#A CONTINUACIÓN, EL PIECHART
bp<-
ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Set2")
#A CONTINUACIÓN, EL PIECHART
bp<-
ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Set3")
#A CONTINUACIÓN, EL PIECHART
bp<-
ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Set3")
#A CONTINUACIÓN, EL PIECHART
bp<-
ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Set1")
#A CONTINUACIÓN, EL PIECHART
bp<-
ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Set3")
bp
#A CONTINUACIÓN, EL PIECHART
bp<-
ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") #+ scale_fill_brewer(palette="Set3")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Spectral")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="RdGy")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="BrGB")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="BrBG")
bp
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="RdYg")
#A CONTINUACIÓN, EL PIECHART
bp<- ggplot(my.summary, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="RdGy")
bp
pie <- bp + coord_polar("y", start=0)
pie
