###Script para alluviales
library(alluvial)
install.packages("alluvial")
install.packages("plyr")
install.packages("biobase")
install.packages("Biobase")
install.packages("GEOquery")
source("https://bioconductor.org/biocLite.R")
biocLite("GEOquery")
install.packages("XML")
install.packages("xml2")
install.packages("xml2")
install.packages("XML")
biocLite("GEOquery")
install.packages("RCurl")
install.packages("rCUR")
install.packages("curl")
install.packages("RCurl")
biocLite("GEOquery")
biocLite("GEOquery")
install.packages("ggplot2")
################################################################
#   Boxplot for selected GEO samples
library(Biobase)
library(GEOquery)
vignette(GEOquery)
vignette("GEOquery")
#A continuación se cargará la librería 'ggplot' para hacer gráficos
library("ggplot2")
#A continuación se cargará la librería 'ggplot' para hacer gráficos
library("ggplot2")
#A continuación se leerán los datos
GEO<-read.csv(file="data/GEO_tablet.tsv", header = T, sep = "\t",
na.strings = "", stringsAsFactors = T)
setwd("~/GEO-R/")
#A continuación se leerán los datos
GEO<-read.csv(file="data/GEO_tablet.tsv", header = T, sep = "\t",
na.strings = "", stringsAsFactors = T)
SPPs <- as.character(GEO$ORGANISMO)
SPPstr<-unlist(strsplit(SPPs, split = ","))
ESPECIES<-as.factor(grep("!Sample_", SPPstr, value = T, invert = T))
ESPECIES.DF<- data.frame(ESPECIES, stringsAsFactors = T)
ESPECIES.DF<-droplevels(ESPECIES.DF)
my.summary<-summary.table(ESPECIES.DF, maxsum = 7)
ESPECIES<-grep("!Sample_", SPPstr, value = T, invert = T)
ESPECIES.DF<- data.frame(ESPECIES, stringsAsFactors = T)
my.summary<-summary.table(ESPECIES.DF, maxsum = 7)
my.summary<-summary.data.frame(ESPECIES.DF, maxsum = 7)
my.summary
my.summary<-summary.data(ESPECIES.DF, maxsum = 7)
my.summary<-summary(ESPECIES.DF, maxsum = 7)
my.summary
ESPECIES.DF<-data.frame(ORGANISMO= c("Homo_sapiens", "Mus_musculus", "Arabidopsis_thaliana",
"Drosophila_melanogaster", "Rattus_novergicus", "Other")
NUMERO_DE_ENTRADAS_EN_LA_TABLA=c(21905, 14898, 1876, 1792, 1506, 14193, 264))
ESPECIES.DF<-data.frame(
ORGANISMO=c("Homo_sapiens", "Mus_musculus", "Arabidopsis_thaliana",
"Drosophila_melanogaster", "Rattus_novergicus", "Other"),
NUMERO_DE_ENTRADAS_EN_LA_TABLA=c(21905, 14898, 1876, 1792, 1506, 14193, 264),
stringsAsFactors = T)
ESPECIES.DF<-data.frame(
ORGANISMO=c("Homo_sapiens", "Mus_musculus", "Arabidopsis_thaliana",
"Drosophila_melanogaster", "Rattus_novergicus", "Other", "NA"),
NUMERO_DE_ENTRADAS_EN_LA_TABLA=c(21905, 14898, 1876, 1792, 1506, 14193, 264),
stringsAsFactors = T)
View(ESPECIES.DF)
####
#A continuación, el piechart
# Barplot
bp<- ggplot(NUMEROS_POR_ESPECIE.DF, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA,
fill= ORGANISMO))+
geom_bar(width = 0.3, stat = "identity")
bp<- ggplot(ESPECIES.DF, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA,
fill= ORGANISMO))+
geom_bar(width = 0.3, stat = "identity")
bp
ESPECIES.DF<-data.frame(
ORGANISMO=c("Homo_sapiens", "Mus_musculus", "Arabidopsis_thaliana",
"Drosophila_melanogaster", "Rattus_novergicus", "Other", "NA"),
NUMERO_DE_ENTRADAS_EN_LA_TABLA=c(21905, 14898, 1876, 1792, 1506, 14193, 264),
stringsAsFactors = T, ordered(NUMERO_DE_ENTRADAS_EN_LA_TABLA))
ESPECIES.DF<-data.frame(
ORGANISMO=c("Homo_sapiens", "Mus_musculus", "Arabidopsis_thaliana",
"Drosophila_melanogaster", "Rattus_novergicus", "Other", "NA"),
NUMERO_DE_ENTRADAS_EN_LA_TABLA=c(21905, 14898, 1876, 1792, 1506, 14193, 264),
stringsAsFactors = T, ordered(ESPECIES.DF))
ESPECIES.DF<-data.frame(
ORGANISMO=c("Homo_sapiens", "Mus_musculus", "Arabidopsis_thaliana",
"Drosophila_melanogaster", "Rattus_novergicus", "Other", "NA"),
NUMERO_DE_ENTRADAS_EN_LA_TABLA=c(21905, 14898, 1876, 1792, 1506, 14193, 264),
stringsAsFactors = T, sort(ESPECIES.DF))
ESPECIES.DF<-data.frame(
ORGANISMO=c("Homo_sapiens", "Mus_musculus", "Arabidopsis_thaliana",
"Drosophila_melanogaster", "Rattus_novergicus", "Other", "NA"),
NUMERO_DE_ENTRADAS_EN_LA_TABLA=c(21905, 14898, 1876, 1792, 1506, 14193, 264),
stringsAsFactors = T, sort(ESPECIES.DF$NUMERO_DE_ENTRADAS_EN_LA_TABLA))
ESPECIES.DF<-data.frame(
ORGANISMO=c("Homo_sapiens", "Mus_musculus", "Arabidopsis_thaliana",
"Drosophila_melanogaster", "Rattus_novergicus", "Other", "NA"),
NUMERO_DE_ENTRADAS_EN_LA_TABLA=c(21905, 14898, 1876, 1792, 1506, 14193, 264),
stringsAsFactors = T)
ESPECIES.DF
bp
pie <- bp + coord_polar("y", start=0)
pie
bp<- ggplot(ESPECIES.DF, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA,
fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity")
bp
pie <- bp + coord_polar("y", start=0)
pie
pdf("results/piechart_especies_tabla_original.pdf")
pie
bp
dev.off()
#####################################################################
#Aquí se hará con 200 líneas para facilitar las pruebas
#Este bloque se tiene que comentar cuando se obtengan los datos completos
GEO<-droplevels(GEO[1:200,])
FINAL_DF <- GEO[0, ]
INTERMEDIATE_DF <- GEO[0, ]
for(i in 1:nrow(GEO)){
message(paste0("Procesando la línea ", i))
CELDA<-as.character(GEO$ORGANISMO[i])
ESPECIES<-unlist(strsplit(CELDA, split = ","))
ESPECIES <- ESPECIES[!grepl('!Sample', ESPECIES)]
#ESPECIES <- ESPECIES [!grepl('1:9', ESPECIES)]
NUMERO_DE_ESPECIES <- length(ESPECIES)
for(x in 1:NUMERO_DE_ESPECIES){
INTERMEDIATE_DF[x,] <-GEO[i,]
INTERMEDIATE_DF[x,"ORGANISMO"] <- ESPECIES[x]
}
FINAL_DF<-rbind(FINAL_DF, INTERMEDIATE_DF)
}
rm(INTERMEDIATE_DF)
GEO.DF<-FINAL_DF
GEO.DF$ORGANISMO<-droplevels(GEO.DF$ORGANISMO)
my.summary <- summary(GEO$ORGANISMO, maxsum = 7)
NUMEROS_POR_ESPECIE.DF<-data.frame(ORGANISMO=names(my.summary), NUMERO_DE_ENTRADAS_EN_LA_TABLA=my.summary)
####
#A continuación, el piechart
# Barplot
bp<- ggplot(NUMEROS_POR_ESPECIE.DF, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA,
fill= ORGANISMO))+
geom_bar(width = 0.3, stat = "identity")
bp
pie <- bp + coord_polar("y", start=0)
pie
####
#A continuación, el piechart
# Barplot
bp<- ggplot(NUMEROS_POR_ESPECIE.DF, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA,
fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity")
bp
pie <- bp + coord_polar("y", start=0)
pie
#A continuación se leerán los datos
GEO<-read.csv(file="data/GEO_tablet.tsv", header = T, sep = "\t",
na.strings = "", stringsAsFactors = T)
SPPs <- as.character(GEO$ORGANISMO)
SPPstr<-unlist(strsplit(SPPs, split = ","))
ESPECIES<-grep("!Sample_", SPPstr, value = T, invert = T)
ESPECIES.DF<- data.frame(ESPECIES, stringsAsFactors = T)
ESPECIES.DF<-droplevels(ESPECIES.DF)
my.summary<-summary.data.frame(ESPECIES.DF, maxsum = 7)
ESPECIES.DF<-data.frame(ORGANISMO=, NUMERO_DE_ENTRADAS_EN_LA_TABLA=my.summary)
ESPECIES.DF<-data.frame(
ORGANISMO=c("Homo_sapiens", "Mus_musculus", "Arabidopsis_thaliana",
"Drosophila_melanogaster", "Rattus_novergicus", "Other", "NA"),
NUMERO_DE_ENTRADAS_EN_LA_TABLA=c(21905, 14898, 1876, 1792, 1506, 14193, 264),
stringsAsFactors = T)
bp<- ggplot(ESPECIES.DF, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA,
fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity")
bp
pie <- bp + coord_polar("y", start=0)
pie
bp<- ggplot(ESPECIES.DF, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA,
fill= ORGANISMO))+
geom_bar(width = 0.3, stat = "identity")
bp
pie <- bp + coord_polar("y", start=0)
pie
bp<- ggplot(ESPECIES.DF, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA,
fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity")
bp
pie <- bp + coord_polar("y", start=0)
pie
View(GEO)
GEO<-GEO[grep(GEO$FECHA_DE_PUBLICACION, pattern = "Public_on_"),]
#A continuación se leerán los datos
GEO<-read.csv(file="data/GEO_tablet.tsv", header = T, sep = "\t",
na.strings = "", stringsAsFactors = T)
GEO.DF<-GEO[grepl(GEO$FECHA_DE_PUBLICACION, pattern = "Public_on_"),]
View(GEO.DF)
####
#A continuación se realizarán gráficos de comparación a lo largo del tiempo
GEO.DF$ANO <-0
GEO.DF$MES <-0
GEO.DF$DIA <-0
GEO.DF$FECHA_DE_PUBLICACION <- as.character(GEO.DF$FECHA_DE_PUBLICACION)
GEO.DF$FECHA_DE_PUBLICACION <- as.character(GEO.DF$FECHA_DE_PUBLICACION)
for(i in 1:nrow(GEO.DF)){
GEO.DF$ANO[i] <- unlist(strsplit(GEO.DF$FECHA_DE_PUBLICACION[i], split = "_"))[5]
GEO.DF$MES[i] <- unlist(strsplit(GEO.DF$FECHA_DE_PUBLICACION[i], split = "_"))[4]
GEO.DF$DIA[i] <- unlist(strsplit(GEO.DF$FECHA_DE_PUBLICACION[i], split = "_"))[3]
}
fechas<- summary(GEO.DF$ANO)
fechas
GEO.DF$ANO <-as.factor(GEO.DF$ANO)
GEO.DF$MES <-as.factor(GEO.DF$MES)
GEO.DF$DIA <-as.factor(GEO.DF$DIA)
fechas<- summary(GEO.DF$ANO)
fechas
NUMEROS_POR_ANO <- data.frame(ANO=names(fechas), NUMERO_DE_ENTRADAS = fechas)
ggplot(NUMEROS_POR_ANO, aes(x=ANO, y=NUMERO_DE_ENTRADAS)) +
geom_point()
####
#A CONTINUACIÓN GRAFICARMOS EL NÚMERO DE PROYECTOS CON DESCRIPCIÓN RESPECTO AL AÑO
#PRIMERO CREAREMOS UN VECTOR CON TODOS LOS AÑOS POSIBLES
anos <- levels(GEO.DF$ANO)
anos
SPPs <- as.character(GEO.DF$ORGANISMO)
SPPstr<-unlist(strsplit(SPPs, split = ","))
ESPECIES<-grep("!Sample_", SPPstr, value = T, invert = T)
ESPECIES.DF<- data.frame(ESPECIES, stringsAsFactors = T)
ESPECIES.DF<-droplevels(ESPECIES.DF)
my.summary<-summary.data.frame(ESPECIES.DF, maxsum = 7)
ESPECIES.DF<-data.frame(ORGANISMO=, NUMERO_DE_ENTRADAS_EN_LA_TABLA=my.summary)
ESPECIES.DF<-data.frame(
ORGANISMO=c("Homo_sapiens", "Mus_musculus", "Arabidopsis_thaliana",
"Drosophila_melanogaster", "Rattus_novergicus", "Other", "NA"),
NUMERO_DE_ENTRADAS_EN_LA_TABLA=c(21905, 14898, 1876, 1792, 1506, 14193, 264),
stringsAsFactors = T)
my.summary<-summary.data.frame(ESPECIES.DF, maxsum = 7)
ESPECIES.DF<-data.frame(ORGANISMO=, NUMERO_DE_ENTRADAS_EN_LA_TABLA=my.summary)
ESPECIES.DF<-data.frame(
ORGANISMO=c("Homo_sapiens", "Mus_musculus", "Arabidopsis_thaliana",
"Drosophila_melanogaster", "Rattus_novergicus", "Other", "NA"),
NUMERO_DE_ENTRADAS_EN_LA_TABLA=c(21905, 14898, 1876, 1792, 1506, 14193, 264),
stringsAsFactors = T)
bp<- ggplot(ESPECIES.DF, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA,
fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity")
bp
pie <- bp + coord_polar("y", start=0)
pie
pie + scale_fill_brewer(palette="Dark2")
my.summary<-summary.data.frame(ESPECIES.DF, maxsum = 7)
my.summary
SPPs <- as.character(GEO.DF$ORGANISMO)
SPPstr<-unlist(strsplit(SPPs, split = ","))
ESPECIES<-grep("!Sample_", SPPstr, value = T, invert = T)
ESPECIES.DF<- data.frame(ESPECIES, stringsAsFactors = T)
ESPECIES.DF<-droplevels(ESPECIES.DF)
my.summary<-summary.data.frame(ESPECIES.DF, maxsum = 7)
my.summary
ESPECIES.DF<-data.frame(
ORGANISMO=c("Homo_sapiens", "Mus_musculus", "Arabidopsis_thaliana",
"Drosophila_melanogaster", "Rattus_novergicus", "Saccharomyces_cerevisiae",
"Other"),
NUMERO_DE_ENTRADAS_EN_LA_TABLA=c(21905, 14898, 1876, 1792, 1506, 1289, 12609),
stringsAsFactors = T)
bp<- ggplot(ESPECIES.DF, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA,
fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity")
bp
pie <- bp + coord_polar("y", start=0)
pie + scale_fill_brewer(palette="Dark2")
order(ESPECIES.DF, decreasing = T)
order(ESPECIES.DF, decreasing = T, na.last = T)
ESPECIES.DF2<-order(ESPECIES.DF, decreasing = T, na.last = T)
rm(ESPECIES.DF2)
View(ESPECIES.DF[order(ESPECIES.DF$NUMERO_DE_ENTRADAS_EN_LA_TABLA, decreasing = T, na.last = T)])
View(ESPECIES.DF[order(ESPECIES.DF$NUMERO_DE_ENTRADAS_EN_LA_TABLA, decreasing = T, na.last = T),])
View(ESPECIES.DF[order(ESPECIES.DF, decreasing = T, na.last = T),])
View(ESPECIES.DF[ordered(ESPECIES.DF, decreasing = T, na.last = T),])
View(ESPECIES.DF[ordered(ESPECIES.DF, decreasing = T),])
help("order")
my.summary
ESPECIES.DF<-data.frame(
ORGANISMO=c("Homo_sapiens", "Mus_musculus", "Arabidopsis_thaliana",
"Drosophila_melanogaster", "Rattus_novergicus", "Saccharomyces_cerevisiae",
"Other"),
NUMERO_DE_ENTRADAS_EN_LA_TABLA=c(21905, 14898, 1876, 1792, 1506, 1289, 12609),
stringsAsFactors = T)
View(ESPECIES.DF)
bp<- ggplot(ESPECIES.DF, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA,
fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity")
bp<- ggplot(ESPECIES.DF, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA,fill= ORGANISMO))+
geom_bar(width = 0.3, stat = "identity")
bp
factor(ESPECIES.DF$ORGANISMO, levels=ESPECIES.DF$ORGANISMO[order(ESPECIES.DF$NUMERO_DE_ENTRADAS_EN_LA_TABLA)])
fctr<-factor(ESPECIES.DF$ORGANISMO, levels=ESPECIES.DF$ORGANISMO[order(ESPECIES.DF$NUMERO_DE_ENTRADAS_EN_LA_TABLA)])
View(fctr)
ESPEC
ESPECIES.DF$ORGANISMO<-fctr
View(ESPECIES.DF)
bp<- ggplot(ESPECIES.DF, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA,fill= ORGANISMO))+
geom_bar(width = 0.3, stat = "identity")
bp
pie <- bp + coord_polar("y", start=0)
pie + scale_fill_brewer(palette="Dark2")
bp<- ggplot(ESPECIES.DF, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA,fill= ORGANISMO))+
geom_bar(width = 0.3, stat = "identity") + scale_fill_brewer(palette="Dark2")
bp
bp<- ggplot(ESPECIES.DF, aes(x=ORGANISMO, y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 0.3, stat = "identity") + scale_fill_brewer(palette="Dark2")
bp
bp<- ggplot(ESPECIES.DF, aes(x=ORGANISMO, y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Dark2")
bp
pie <- bp + coord_polar("y", start=0)
pie + scale_fill_brewer(palette="Dark2")
bp<- ggplot(ESPECIES.DF, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Dark2")
bp
bp<- ggplot(ESPECIES.DF, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 0.3, stat = "identity") + scale_fill_brewer(palette="Dark2")
bp
pie <- bp + coord_polar("y", start=0)
pie + scale_fill_brewer(palette="Dark2")
bp<- ggplot(ESPECIES.DF, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Dark2")
bp
pie <- bp + coord_polar("y", start=0)
pie + scale_fill_brewer(palette="Dark2")
bp<- ggplot(ESPECIES.DF, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity") + scale_fill_brewer(palette="Dark2")
bp
pie <- bp + coord_polar("y", start=0) + scale_fill_brewer(palette="Dark2")
pie
pie <- bp + coord_polar("y", start=0)
pie + scale_fill_brewer(palette="Dark2")
SPPs <- as.character(GEO.DF$ORGANISMO)
SPPstr<-unlist(strsplit(SPPs, split = ","))
ESPECIES<-grep("!Sample_", SPPstr, value = T, invert = T)
ESPECIES.DF<- data.frame(ESPECIES, stringsAsFactors = T)
ESPECIES.DF<-droplevels(ESPECIES.DF)
my.summary<-summary.data.frame(ESPECIES.DF, maxsum = 7)
my.summary
####
#A continuación se realizarán gráficos de comparación a lo largo del tiempo
GEO.DF$ANO <-0
GEO.DF$MES <-0
GEO.DF$DIA <-0
GEO.DF$FECHA_DE_PUBLICACION <- as.character(GEO.DF$FECHA_DE_PUBLICACION)
for(i in 1:nrow(GEO.DF)){
GEO.DF$ANO[i] <- unlist(strsplit(GEO.DF$FECHA_DE_PUBLICACION[i], split = "_"))[5]
GEO.DF$MES[i] <- unlist(strsplit(GEO.DF$FECHA_DE_PUBLICACION[i], split = "_"))[4]
GEO.DF$DIA[i] <- unlist(strsplit(GEO.DF$FECHA_DE_PUBLICACION[i], split = "_"))[3]
}
GEO.DF$ANO <-as.factor(GEO.DF$ANO)
GEO.DF$MES <-as.factor(GEO.DF$MES)
GEO.DF$DIA <-as.factor(GEO.DF$DIA)
fechas<- summary(GEO.DF$ANO)
NUMEROS_POR_ANO <- data.frame(ANO=names(fechas), NUMERO_DE_ENTRADAS = fechas)
ggplot(NUMEROS_POR_ANO, aes(x=ANO, y=NUMERO_DE_ENTRADAS)) +
geom_point()
####
#A CONTINUACIÓN GRAFICARMOS EL NÚMERO DE PROYECTOS CON DESCRIPCIÓN RESPECTO AL AÑO
#PRIMERO CREAREMOS UN VECTOR CON TODOS LOS AÑOS POSIBLES
anos <- levels(GEO.DF$ANO)
DATOS_POR_ANO.DF <- data.frame(ANO=factor(anos),
CON_RESUMEN=integer(length(anos)),
SIN_RESUMEN=integer(length(anos)),
TOTAL_DE_CARACTERES=numeric(length(anos)),
ARRAY=integer(length(anos)),
SEQ=integer(length(anos)),
NUMERO_DE_ESTUDIOS_EN_HUMANO =integer(length(anos)),
NUMERO_DE_ESTUDIOS_EN_RATON=integer(length(anos)),
stringsAsFactors=FALSE)
GEO.DF$RESUMEN_DEL_PROYECTO<-as.character(GEO.DF$RESUMEN_DEL_PROYECTO)
for (i in 1:nrow(DATOS_POR_ANO.DF)){
DATOS_POR_ANO.DF$ANO[i] <-  anos[i]
DATOS_POR_ANO.DF$CON_RESUMEN[i] <-sum(!is.na(GEO.DF[GEO.DF$ANO == anos[i],"RESUMEN_DEL_PROYECTO"]))
DATOS_POR_ANO.DF$SIN_RESUMEN[i]<-sum(is.na(GEO.DF[GEO.DF$ANO == anos[i],"RESUMEN_DEL_PROYECTO"]))
DATOS_POR_ANO.DF$TOTAL_DE_CARACTERES[i]<- nchar(paste(GEO.DF[GEO.DF$ANO == anos[i],"RESUMEN_DEL_PROYECTO"], collapse = "")) / DATOS_POR_ANO.DF$CON_RESUMEN[i]
DATOS_POR_ANO.DF$ARRAY[i]<-length(grep("array", GEO.DF[GEO.DF$ANO == anos[i], "SERIES_TYPE"]))
DATOS_POR_ANO.DF$SEQ[i]<-length(grep("seq", GEO.DF[GEO.DF$ANO == anos[i], "SERIES_TYPE"]))
DATOS_POR_ANO.DF$NUMERO_DE_ESTUDIOS_EN_HUMANO[i]<-length(grep("Homo_sapiens", GEO.DF[GEO.DF$ANO == anos[i], "ORGANISMO"]))
DATOS_POR_ANO.DF$NUMERO_DE_ESTUDIOS_EN_RATON[i]<-length(grep("Mus_musculus", GEO.DF[GEO.DF$ANO == anos[i], "ORGANISMO"]))
}
ggplot(DATOS_POR_ANO.DF, aes(x=ANO, y=TOTAL_DE_CARACTERES)) +
geom_point()
View(DATOS_POR_ANO.DF)
A<-GEO.DF[grep(GEO.DF$FECHA_DE_PUBLICACION,"2001"), ]
DATOS_POR_ANO.DF <- data.frame(ANO=factor(anos),
CON_RESUMEN=integer(length(anos)),
SIN_RESUMEN=integer(length(anos)),
TOTAL_DE_CARACTERES=numeric(length(anos)),
ARRAY=integer(length(anos)),
SEQ=integer(length(anos)),
NUMERO_DE_ESTUDIOS_EN_HUMANO =integer(length(anos)),
NUMERO_DE_ESTUDIOS_EN_RATON=integer(length(anos)),
stringsAsFactors=FALSE)
A<-GEO.DF[grep(GEO.DF$FECHA_DE_PUBLICACION,"Public_on_2001"), ]
A<-GEO.DF[grep("Public_on_2001", GEO.DF$FECHA_DE_PUBLICACION), ]
A<-GEO.DF[grep(pattern = "Public_on_2001", x= GEO.DF$FECHA_DE_PUBLICACION, value = T), ]
View(A)
DATOS_POR_ANO.DF <- data.frame(ANO=factor(anos),
CON_RESUMEN=integer(length(anos)),
SIN_RESUMEN=integer(length(anos)),
TOTAL_DE_CARACTERES=numeric(length(anos)),
ARRAY=integer(length(anos)),
SEQ=integer(length(anos)),
NUMERO_DE_ESTUDIOS_EN_HUMANO =integer(length(anos)),
NUMERO_DE_ESTUDIOS_EN_RATON=integer(length(anos)),
stringsAsFactors=FALSE)
GEO.DF$RESUMEN_DEL_PROYECTO<-as.character(GEO.DF$RESUMEN_DEL_PROYECTO)
anos
rm(A)
View(DATOS_POR_ANO.DF)
View(DATOS_POR_ANO.DF)
for (i in 1:nrow(DATOS_POR_ANO.DF)){
DATOS_POR_ANO.DF$ANO[i] <- anos[i]
DATOS_POR_ANO.DF$CON_RESUMEN[i] <-sum(!is.na(GEO.DF[GEO.DF$ANO == anos[i],"RESUMEN_DEL_PROYECTO"]))
DATOS_POR_ANO.DF$SIN_RESUMEN[i]<-sum(is.na(GEO.DF[GEO.DF$ANO == anos[i],"RESUMEN_DEL_PROYECTO"]))
DATOS_POR_ANO.DF$TOTAL_DE_CARACTERES[i]<- nchar(paste(GEO.DF[GEO.DF$ANO == anos[i],"RESUMEN_DEL_PROYECTO"], collapse = "")) / DATOS_POR_ANO.DF$CON_RESUMEN[i]
DATOS_POR_ANO.DF$ARRAY[i]<-length(grep("array", GEO.DF[GEO.DF$ANO == anos[i], "SERIES_TYPE"]))
DATOS_POR_ANO.DF$SEQ[i]<-length(grep("seq", GEO.DF[GEO.DF$ANO == anos[i], "SERIES_TYPE"]))
DATOS_POR_ANO.DF$NUMERO_DE_ESTUDIOS_EN_HUMANO[i]<-length(grep("Homo_sapiens", GEO.DF[GEO.DF$ANO == anos[i], "ORGANISMO"]))
DATOS_POR_ANO.DF$NUMERO_DE_ESTUDIOS_EN_RATON[i]<-length(grep("Mus_musculus", GEO.DF[GEO.DF$ANO == anos[i], "ORGANISMO"]))
}
ggplot(DATOS_POR_ANO.DF, aes(x=ANO, y=ARRAY)) +
geom_point()
ggplot(DATOS_POR_ANO.DF, aes(x=ANO, y=SEQ)) +
geom_point()
ggplot(DATOS_POR_ANO.DF, aes(x=ANO, y=ARRAY)) +
geom_point()
ggplot(DATOS_POR_ANO.DF, aes(x=ANO, y=SEQ)) +
geom_point()
View(DATOS_POR_ANO.DF)
ggplot(DATOS_POR_ANO.DF, aes(x=ANO, y=NUMERO_DE_ESTUDIOS_EN_HUMANO)) +
geom_point()
ggplot(DATOS_POR_ANO.DF, aes(x=ANO, y=NUMERO_DE_ESTUDIOS_EN_RATON)) +
geom_point()
ggplot(DATOS_POR_ANO.DF, aes(x=ANO, y=NUMERO_DE_ESTUDIOS_EN_RATON+NUMERO_DE_ESTUDIOS_EN_HUMANO)) +
geom_point()
bp<- ggplot(DATOS_POR_ANO.DF, aes(x=ANO, y=NUMERO_DE_ESTUDIOS_EN_RATON + NUMERO_DE_ESTUDIOS_EN_HUMANO, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity")
bp + scale_fill_brewer(palette="Dark2")
bp<- ggplot(DATOS_POR_ANO.DF, aes(x=ANO, y=NUMERO_DE_ESTUDIOS_EN_RATON + NUMERO_DE_ESTUDIOS_EN_HUMANO))+
geom_bar(width = 1, stat = "identity")
bp + scale_fill_brewer(palette="Dark2")
bp<- ggplot(DATOS_POR_ANO.DF, aes(x=ANO, y=c(NUMERO_DE_ESTUDIOS_EN_RATON, NUMERO_DE_ESTUDIOS_EN_HUMANO))+
bp<- ggplot(DATOS_POR_ANO.DF, aes(x=ANO, y=c(NUMERO_DE_ESTUDIOS_EN_RATON, NUMERO_DE_ESTUDIOS_EN_HUMANO)))+
geom_bar(width = 1, stat = "identity")
s
bp<- ggplot(DATOS_POR_ANO.DF, aes(x=ANO, y=c(NUMERO_DE_ESTUDIOS_EN_RATON, NUMERO_DE_ESTUDIOS_EN_HUMANO)))+
geom_bar(width = 1, stat = "identity")
bp + scale_fill_brewer(palette="Dark2")
