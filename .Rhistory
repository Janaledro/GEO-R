###Script para alluviales
library(alluvial)
install.packages("alluvial")
install.packages("plyr")
install.packages("biobase")
install.packages("Biobase")
install.packages("GEOquery")
source("https://bioconductor.org/biocLite.R")
biocLite("GEOquery")
install.packages("XML")
install.packages("xml2")
install.packages("xml2")
install.packages("XML")
biocLite("GEOquery")
install.packages("RCurl")
install.packages("rCUR")
install.packages("curl")
install.packages("RCurl")
biocLite("GEOquery")
biocLite("GEOquery")
install.packages("ggplot2")
################################################################
#   Boxplot for selected GEO samples
library(Biobase)
library(GEOquery)
vignette(GEOquery)
vignette("GEOquery")
#A continuación se cargará la librería 'ggplot' para hacer gráficos
library("ggplot2")
library("alluvial")
#A continuación se leerán los datos
GEO<-read.csv(file="data/GEO_tablet.tsv", header = T, sep = "\t",
na.strings = "", stringsAsFactors = T)
setwd("~/GEO-R/")
#A continuación se leerán los datos
GEO<-read.csv(file="data/GEO_tablet.tsv", header = T, sep = "\t",
na.strings = "", stringsAsFactors = T)
GEO.DF<-GEO[grepl(GEO$FECHA_DE_PUBLICACION, pattern = "Public_on_"),]
SPPs <- as.character(GEO.DF$ORGANISMO)
SPPstr<-unlist(strsplit(SPPs, split = ","))
ESPECIES<-grep("!Sample_", SPPstr, value = T, invert = T)
ESPECIES.DF<- data.frame(ESPECIES, stringsAsFactors = T)
ESPECIES.DF<-droplevels(ESPECIES.DF)
my.summary<-summary.data.frame(ESPECIES.DF, maxsum = 7)
#ESPECIES.DF<-data.frame(ORGANISMO=, NUMERO_DE_ENTRADAS_EN_LA_TABLA=my.summary)
ESPECIES.DF<-data.frame(
ORGANISMO=c("Homo_sapiens", "Mus_musculus", "Arabidopsis_thaliana",
"Drosophila_melanogaster", "Rattus_novergicus", "Saccharomyces_cerevisiae",
"Other"),
NUMERO_DE_ENTRADAS_EN_LA_TABLA=c(21905, 14898, 1876, 1792, 1506, 1289, 12609),
stringsAsFactors = T)
bp<- ggplot(ESPECIES.DF, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity")
bp + scale_fill_brewer(palette="Dark2")
pie <- bp + coord_polar("y", start=0)
pie + scale_fill_brewer(palette="Dark2")
#A continuación se cargará la librería 'ggplot' para hacer gráficos
library("ggplot2")
library("reshape2")
library("alluvial")
bp<- ggplot(ESPECIES.DF, aes(x="", y=NUMERO_DE_ENTRADAS_EN_LA_TABLA, fill= ORGANISMO))+
geom_bar(width = 1, stat = "identity")
bp + scale_fill_brewer(palette="Dark2")
pie <- bp + coord_polar("y", start=0)
pie + scale_fill_brewer(palette="Dark2")
pdf("results/piechart_especies_tabla_original.pdf")
pdf("results/piechart_especies_tabla_original.pdf")
pie
bp
dev.off()
####
#A continuación se realizarán gráficos de comparación a lo largo del tiempo
GEO.DF$ANO <-0
GEO.DF$MES <-0
GEO.DF$DIA <-0
GEO.DF$FECHA_DE_PUBLICACION <- as.character(GEO.DF$FECHA_DE_PUBLICACION)
for(i in 1:nrow(GEO.DF)){
GEO.DF$ANO[i] <- unlist(strsplit(GEO.DF$FECHA_DE_PUBLICACION[i], split = "_"))[5]
GEO.DF$MES[i] <- unlist(strsplit(GEO.DF$FECHA_DE_PUBLICACION[i], split = "_"))[4]
GEO.DF$DIA[i] <- unlist(strsplit(GEO.DF$FECHA_DE_PUBLICACION[i], split = "_"))[3]
}
GEO.DF$FECHA_DE_PUBLICACION <- as.character(GEO.DF$FECHA_DE_PUBLICACION)
for(i in 1:nrow(GEO.DF)){
message(paste0("Operando sobre la línea ", i))
GEO.DF$ANO[i] <- unlist(strsplit(GEO.DF$FECHA_DE_PUBLICACION[i], split = "_"))[5]
GEO.DF$MES[i] <- unlist(strsplit(GEO.DF$FECHA_DE_PUBLICACION[i], split = "_"))[4]
GEO.DF$DIA[i] <- unlist(strsplit(GEO.DF$FECHA_DE_PUBLICACION[i], split = "_"))[3]
}
GEO.DF$ANO <-as.factor(GEO.DF$ANO)
GEO.DF$MES <-as.factor(GEO.DF$MES)
GEO.DF$DIA <-as.factor(GEO.DF$DIA)
fechas<- summary(GEO.DF$ANO)
fechas
NUMEROS_POR_ANO <- data.frame(ANO=names(fechas), NUMERO_DE_ENTRADAS = fechas)
ggplot(NUMEROS_POR_ANO, aes(x=ANO, y=NUMERO_DE_ENTRADAS)) +
geom_point()
####
#A CONTINUACIÓN GRAFICARMOS EL NÚMERO DE PROYECTOS CON DESCRIPCIÓN RESPECTO AL AÑO
#PRIMERO CREAREMOS UN VECTOR CON TODOS LOS AÑOS POSIBLES
anos <- levels(GEO.DF$ANO)
anos
DATOS_POR_ANO.DF <- data.frame(ANO=factor(anos),
CON_RESUMEN=integer(length(anos)),
SIN_RESUMEN=integer(length(anos)),
TOTAL_DE_CARACTERES=numeric(length(anos)),
ARRAY=integer(length(anos)),
SEQ=integer(length(anos)),
NUMERO_DE_ESTUDIOS_EN_HUMANO =integer(length(anos)),
NUMERO_DE_ESTUDIOS_EN_RATON=integer(length(anos)),
stringsAsFactors=FALSE)
GEO.DF$RESUMEN_DEL_PROYECTO<-as.character(GEO.DF$RESUMEN_DEL_PROYECTO)
for (i in 1:nrow(DATOS_POR_ANO.DF)){
DATOS_POR_ANO.DF$ANO[i] <- anos[i]
DATOS_POR_ANO.DF$CON_RESUMEN[i] <-sum(!is.na(GEO.DF[GEO.DF$ANO == anos[i],"RESUMEN_DEL_PROYECTO"]))
DATOS_POR_ANO.DF$SIN_RESUMEN[i]<-sum(is.na(GEO.DF[GEO.DF$ANO == anos[i],"RESUMEN_DEL_PROYECTO"]))
DATOS_POR_ANO.DF$TOTAL_DE_CARACTERES[i]<- nchar(paste(GEO.DF[GEO.DF$ANO == anos[i],"RESUMEN_DEL_PROYECTO"], collapse = "")) / DATOS_POR_ANO.DF$CON_RESUMEN[i]
DATOS_POR_ANO.DF$ARRAY[i]<-length(grep("array", GEO.DF[GEO.DF$ANO == anos[i], "SERIES_TYPE"]))
DATOS_POR_ANO.DF$SEQ[i]<-length(grep("seq", GEO.DF[GEO.DF$ANO == anos[i], "SERIES_TYPE"]))
DATOS_POR_ANO.DF$NUMERO_DE_ESTUDIOS_EN_HUMANO[i]<-length(grep("Homo_sapiens", GEO.DF[GEO.DF$ANO == anos[i], "ORGANISMO"]))
DATOS_POR_ANO.DF$NUMERO_DE_ESTUDIOS_EN_RATON[i]<-length(grep("Mus_musculus", GEO.DF[GEO.DF$ANO == anos[i], "ORGANISMO"]))
}
for (i in 1:nrow(DATOS_POR_ANO.DF)){
message(paste0("Creando el data frame en la línea ", i))
DATOS_POR_ANO.DF$ANO[i] <- anos[i]
DATOS_POR_ANO.DF$CON_RESUMEN[i] <-sum(!is.na(GEO.DF[GEO.DF$ANO == anos[i],"RESUMEN_DEL_PROYECTO"]))
DATOS_POR_ANO.DF$SIN_RESUMEN[i]<-sum(is.na(GEO.DF[GEO.DF$ANO == anos[i],"RESUMEN_DEL_PROYECTO"]))
DATOS_POR_ANO.DF$TOTAL_DE_CARACTERES[i]<- nchar(paste(GEO.DF[GEO.DF$ANO == anos[i],"RESUMEN_DEL_PROYECTO"], collapse = "")) / DATOS_POR_ANO.DF$CON_RESUMEN[i]
DATOS_POR_ANO.DF$ARRAY[i]<-length(grep("array", GEO.DF[GEO.DF$ANO == anos[i], "SERIES_TYPE"]))
DATOS_POR_ANO.DF$SEQ[i]<-length(grep("seq", GEO.DF[GEO.DF$ANO == anos[i], "SERIES_TYPE"]))
DATOS_POR_ANO.DF$NUMERO_DE_ESTUDIOS_EN_HUMANO[i]<-length(grep("Homo_sapiens", GEO.DF[GEO.DF$ANO == anos[i], "ORGANISMO"]))
DATOS_POR_ANO.DF$NUMERO_DE_ESTUDIOS_EN_RATON[i]<-length(grep("Mus_musculus", GEO.DF[GEO.DF$ANO == anos[i], "ORGANISMO"]))
}
#REALIZACIÓN DE ALLUVIAL PLOT PARA SUMARIZAR LA INFORMACIÓN PREVIA
FRAME.DF<-data.frame(DATOS_POR_ANO.DF$ANO, DATOS_POR_ANO.DF$NUMERO_DE_ESTUDIOS_EN_HUMANO,
DATOS_POR_ANO.DF$NUMERO_DE_ESTUDIOS_EN_RATON, DATOS_POR_ANO.DF$ARRAY,
DATOS_POR_ANO.DF$SEQ)
data.m<-melt(FRAME.DF, id.vars= "ANO")
View(FRAME.DF)
#REALIZACIÓN DE ALLUVIAL PLOT PARA SUMARIZAR LA INFORMACIÓN PREVIA
FRAME.DF<-data.frame(DANO=ATOS_POR_ANO.DF$ANO,
NUMERO_DE_ESTUDIOS_EN_HUMANO=DATOS_POR_ANO.DF$NUMERO_DE_ESTUDIOS_EN_HUMANO,
NUMERO_DE_ESTUDIOS_EN_RATON=DATOS_POR_ANO.DF$NUMERO_DE_ESTUDIOS_EN_RATON,
ARRAY=DATOS_POR_ANO.DF$ARRAY,
SEQ=DATOS_POR_ANO.DF$SEQ)
#REALIZACIÓN DE ALLUVIAL PLOT PARA SUMARIZAR LA INFORMACIÓN PREVIA
FRAME.DF<-data.frame(ANO=DATOS_POR_ANO.DF$ANO,
NUMERO_DE_ESTUDIOS_EN_HUMANO=DATOS_POR_ANO.DF$NUMERO_DE_ESTUDIOS_EN_HUMANO,
NUMERO_DE_ESTUDIOS_EN_RATON=DATOS_POR_ANO.DF$NUMERO_DE_ESTUDIOS_EN_RATON,
ARRAY=DATOS_POR_ANO.DF$ARRAY,
SEQ=DATOS_POR_ANO.DF$SEQ)
data.m<-melt(FRAME.DF, id.vars= "ANO")
View(data.m)
vignette(alluvial)
vignette("alluvial")
#REALIZACIÓN DE ALLUVIAL PLOT PARA SUMARIZAR LA INFORMACIÓN PREVIA
FRAME.DF<-data.frame(ANO=DATOS_POR_ANO.DF$ANO,
NUMERO_DE_ESTUDIOS_EN_HUMANO=DATOS_POR_ANO.DF$NUMERO_DE_ESTUDIOS_EN_HUMANO,
NUMERO_DE_ESTUDIOS_EN_RATON=DATOS_POR_ANO.DF$NUMERO_DE_ESTUDIOS_EN_RATON,
ARRAY=DATOS_POR_ANO.DF$ARRAY,
SEQ=DATOS_POR_ANO.DF$SEQ, stringsAsFactors = F)
data.m<-melt(FRAME.DF, id.vars= "ANO")
alluvial(data.m, freq = value)
alluvial(data.m, freq = data.m$value)
#REALIZACIÓN DE ALLUVIAL PLOT PARA SUMARIZAR LA INFORMACIÓN PREVIA
FRAME.DF<-data.frame(ANO=DATOS_POR_ANO.DF$ANO,
NUMERO_DE_ESTUDIOS_EN_HUMANO=DATOS_POR_ANO.DF$NUMERO_DE_ESTUDIOS_EN_HUMANO,
NUMERO_DE_ESTUDIOS_EN_RATON=DATOS_POR_ANO.DF$NUMERO_DE_ESTUDIOS_EN_RATON,
ARRAY=DATOS_POR_ANO.DF$ARRAY,
SEQ=DATOS_POR_ANO.DF$SEQ, stringsAsFactors = T)
data.m<-melt(FRAME.DF, id.vars= "ANO")
alluvial(data.m, freq = data.m$value)
ARRAYvsSEQ.DF<-data.frame(ANO=DATOS_POR_ANO.DF$ANO,
ARRAY=DATOS_POR_ANO.DF$ARRAY,
SEQ=DATOS_POR_ANO.DF$SEQ,
stringsAsFactors = F)
arrayvsseq.melt<-melt(ARRAYvsSEQ.DF, id.vars = "ANO")
alluvial(arrayvsseq.melt, freq = arrayvsseq.melt$value)
summary(ARRAYvsSEQ.DF)
summary.data.frame(ARRAYvsSEQ.DF)
ARRAYvsSEQ.DF<-data.frame(ANO=DATOS_POR_ANO.DF$ANO,
ARRAY=DATOS_POR_ANO.DF$ARRAY,
SEQ=DATOS_POR_ANO.DF$SEQ,
stringsAsFactors = T)
summary.data.frame(ARRAYvsSEQ.DF)
View(ARRAYvsSEQ.DF)
View(arrayvsseq.melt)
arrayvsseq<-subset(arrayvsseq.melt, select = -ANO)
View(arrayvsseq)
alluvial(arrayvsseq, freq = arrayvsseq$value)
install.packages("dplyr")
library("dplyr")
summary.data.frame(ARRAYvsSEQ.DF)
#GRÁFICA QUE COMPARA ESTUDIOS REALIZADOS EN HUMANOS VS RATÓN CON BARRAS
ggplot(ARRAYvsSEQ.DF, aes(ANO, value))+
geom_bar(aes( fill= variable), position= "dodge", stat="identity") +
scale_fill_brewer(palette="Dark2")
#GRÁFICA QUE COMPARA ESTUDIOS REALIZADOS EN HUMANOS VS RATÓN CON PUNTOS
ggplot(arrayvsseq.melt, aes(x=ANO, y=value)) +
geom_point(aes(fill=variable, color=variable)) + scale_color_brewer(palette="Set1")
#GRÁFICA QUE COMPARA ESTUDIOS REALIZADOS EN HUMANOS VS RATÓN CON BARRAS
ggplot(arrayvsseq.melt, aes(ANO, value))+
geom_bar(aes( fill= variable), position= "dodge", stat="identity") +
scale_fill_brewer(palette="Dark2")
#GRÁFICA QUE COMPARA ESTUDIOS REALIZADOS EN MICROARREGLOS VS SECUENCIACIÓN CON PUNTOS
ggplot(arrayvsseq.melt, aes(x=ANO, y=value)) +
geom_point(aes(fill=variable, color=variable)) + scale_color_brewer(palette="Set1")
gpz<-ggplot(NUMEROS_POR_ANO, aes(x=ANO, y=NUMERO_DE_ENTRADAS)) +
geom_point()
gp<-ggplot(NUMEROS_POR_ANO, aes(x=ANO, y=NUMERO_DE_ENTRADAS)) +
geom_point()
gp
ggplot(DATOS_POR_ANO.DF, aes(x=ANO, y=TOTAL_DE_CARACTERES)) +
geom_point()
gp_tdc<-ggplot(DATOS_POR_ANO.DF, aes(x=ANO, y=TOTAL_DE_CARACTERES)) +
geom_point()
#GRÁFICA DE ESTUDIOS CON MICROARREGOS VS AÑOS
gp_microarreglos_vs_años<-ggplot(DATOS_POR_ANO.DF, aes(x=ANO, y=ARRAY)) +
geom_point()
#GRÁFICA DE ESTUDIOS CON SECUENCIACIÓN VS AÑOS
gp_seq_vs_años<-ggplot(DATOS_POR_ANO.DF, aes(x=ANO, y=SEQ)) +
geom_point()
#GRÁFICA DE ESTUDIOS EN HUMANO VS AÑOS
gp_hs_vs_anos<-ggplot(DATOS_POR_ANO.DF, aes(x=ANO, y=NUMERO_DE_ESTUDIOS_EN_HUMANO)) +
geom_point()
#GRÁFICA DE ESTUDIOS EN RATÓN VS AÑOS
gp_mm_vs_anos<-ggplot(DATOS_POR_ANO.DF, aes(x=ANO, y=NUMERO_DE_ESTUDIOS_EN_RATON)) +
geom_point() + geom_line()
#GRÁFICA QUE COMPARA ESTUDIOS REALIZADOS EN HUMANOS VS RATÓN CON BARRAS
bp_hs_vs_mm<-ggplot(data.m, aes(ANO, value))+
geom_bar(aes( fill= variable), position= "dodge", stat="identity") +
scale_fill_brewer(palette="Dark2")
#GRÁFICA QUE COMPARA ESTUDIOS REALIZADOS EN HUMANOS VS RATÓN CON PUNTOS
gp_hs_vs_mm<-ggplot(data.m, aes(x=ANO, y=value)) +
geom_point(aes(fill=variable, color=variable)) +
scale_color_brewer(palette="Set1")
#REALIZACIÓN DE ALLUVIAL PLOT PARA SUMARIZAR LA INFORMACIÓN PREVIA
FRAME.DF<-data.frame(ANO=DATOS_POR_ANO.DF$ANO,
NUMERO_DE_ESTUDIOS_EN_HUMANO=DATOS_POR_ANO.DF$NUMERO_DE_ESTUDIOS_EN_HUMANO,
NUMERO_DE_ESTUDIOS_EN_RATON=DATOS_POR_ANO.DF$NUMERO_DE_ESTUDIOS_EN_RATON,
ARRAY=DATOS_POR_ANO.DF$ARRAY,
SEQ=DATOS_POR_ANO.DF$SEQ, stringsAsFactors = T)
data.m<-melt(FRAME.DF, id.vars= "ANO")
alluvial(data.m, freq = data.m$value)
alluvial1<-alluvial(data.m, freq = data.m$value)
alluvial(arrayvsseq, freq = arrayvsseq$value)
alluvial2<-alluvial(arrayvsseq, freq = arrayvsseq$value)
View(arrayvsseq.melt)
View(arrayvsseq.melt)
pdf("results/piechart_especies_tabla_original.pdf")
pie
bp
gp
gp_hs_vs_anos
gp_hs_vs_mm
gp_microarreglos_vs_años
gp_mm_vs_anos
gp_seq_vs_anos
gp_tdc
dev.off()
